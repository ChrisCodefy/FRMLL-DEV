<section class="custom-product-section">
  <div class="custom-container">
    <h2 class="custom-heading">{{ section.settings.heading }}</h2>

    <div class="swiper custom-swiper">
      <div class="swiper-wrapper">
        {% for product in collections[section.settings.collection].products limit: section.settings.products_to_show %}
          <div class="swiper-slide">
            <div class="custom-product-card">
              <a href="{{ product.url }}">
                <img src="{{ product.featured_image | img_url: '500x' }}" alt="{{ product.title }}" class="custom-product-image">
              </a>
              <div class="custom-product-details">
                <h3 class="custom-product-title">{{ product.title }}</h3>
                {% if product.compare_at_price > product.price %}
                  <p class="custom-product-price">
                    <span class="custom-price-original">{{ product.compare_at_price | money }}</span>
                    <span class="custom-price-sale">{{ product.price | money }}</span>
                  </p>
                {% else %}
                  <p class="custom-product-price">{{ product.price | money }}</p>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>

<style>
.custom-product-section {
  background: #f3f2eb;
  padding: 40px 0;
}

.custom-heading {
  text-align: start;
  font-size: 24px;
  margin-bottom: 30px;
  margin-left: 2rem;
}

.swiper {
  padding: 0 2rem;
}

.swiper-wrapper {
  display: flex;
}

.swiper-slide {
  flex-shrink: 0;
  width: 100%; /* Será controlado por Swiper */
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

.custom-product-card {
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  padding: 0;
  margin: 0;
  border-block: 2px solid #000;
  border-inline: 1px solid #000;
}

.custom-product-image {
  width: 100%;
  height: auto;
  border-bottom: 2px solid #000;
}

.custom-product-details {
  padding: 10px;
}

.custom-product-title {
  font-size: 1.8rem;
  margin: 10px 0 5px;
  font-weight: 500;
  text-transform: uppercase;
}

.custom-product-price {
  font-size: 14px;
  color: #000;
}

.custom-price-original {
  text-decoration: line-through;
  color: #888;
  margin-right: 5px;
}

.custom-price-sale {
  color: #e60073;
  font-weight: bold;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    new Swiper('.custom-swiper', {
      loop: true,
      slidesPerView: 1,
      spaceBetween: 0,
      breakpoints: {
        640: { slidesPerView: 2 },
        768: { slidesPerView: 3 },
        1024: { slidesPerView: 4 }
      },
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      }
    });
  });
</script>

{% schema %}
{
  "name": "Custom Product Grid",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "EXIT THROUGH THE BOOK SHOP"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Número de productos a mostrar",
      "min": 2,
      "max": 20,
      "step": 1,
      "default": 8
    }
  ],
  "presets": [
    {
      "name": "Custom Product Grid",
      "category": "Custom Sections"
    }
  ]
}
{% endschema %}
